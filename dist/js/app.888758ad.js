(function(e){function t(t){for(var s,i,o=t[0],l=t[1],c=t[2],d=0,v=[];d<o.length;d++)i=o[d],r[i]&&v.push(r[i][0]),r[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);u&&u(t);while(v.length)v.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],s=!0,o=1;o<a.length;o++){var l=a[o];0!==r[l]&&(s=!1)}s&&(n.splice(t--,1),e=i(i.s=a[0]))}return e}var s={},r={app:0},n=[];function i(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=s,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(a,s,function(t){return e[t]}.bind(null,s));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/betsy/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:""}},[a("v-toolbar-title",{staticClass:"headline text-uppercase"},[a("span",{staticClass:"mr-2"},[e._v("Betsy")]),a("span",{staticClass:"font-weight-light"},[e._v("alpha 0.2")])]),a("v-spacer"),a("v-toolbar-items",[this.$store.getters.activeGame?a("v-btn",{attrs:{text:""},on:{click:function(t){return e.onLeaveGame()}}},[a("v-icon",{attrs:{small:"",left:""}},[e._v("mdi-exit-run")]),e._v("\n        Leave game\n      ")],1):e._e()],1)],1),a("div",{staticClass:"text-center"},[a("v-overlay",{attrs:{value:this.$store.getters.loader}},[a("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1)],1),a("v-content",{staticClass:"mt-0 ml-0 mr-0"},[a("router-view")],1)],1)},n=[],i={data:()=>({}),methods:{onLeaveGame(){this.$store.dispatch("leaveGame")}}},o=i,l=a("2877"),c=a("6544"),u=a.n(c),d=a("7496"),v=a("40dc"),h=a("8336"),p=a("a75b"),m=a("132d"),g=a("a797"),f=a("490a"),b=a("2fa4"),y=a("2a7f"),w=Object(l["a"])(o,r,n,!1,null,null,null),x=w.exports;u()(w,{VApp:d["a"],VAppBar:v["a"],VBtn:h["a"],VContent:p["a"],VIcon:m["a"],VOverlay:g["a"],VProgressCircular:f["a"],VSpacer:b["a"],VToolbarItems:y["a"],VToolbarTitle:y["b"]});var _=a("8c4f"),$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm8:"","offset-sm2":""}},[a("h3",[e._v("Welcome!! Join or create a new game")]),a("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(t){return t.preventDefault(),e.enterGameButton(t)}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-text-field",{attrs:{rules:e.playerNameRules,label:"Player name",required:"",tabindex:"1"},model:{value:e.playerName,callback:function(t){e.playerName=t},expression:"playerName"}}),e._e(),a("v-text-field",{attrs:{counter:5,rules:[e.checkGameId],label:"Game ID",required:"",tabindex:"2"},model:{value:e.gameID,callback:function(t){e.gameID=t},expression:"gameID"}}),a("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success",tabindex:"3",type:"submit"}},[e._v("\n          Join\n        ")])],1)],1)],1),a("v-layout",{attrs:{"mt-6":""}},[a("v-flex",{staticClass:"caption",attrs:{xs12:"",sm8:"","offset-sm2":""}},[e._v("\n      Try ABCDE or FGHIJ as games...\n    ")])],1)],1)},D=[],V={data:()=>({valid:!0,NameDialog:!1,playerName:"",playerNameRules:[e=>!!e||"Player name is required",e=>e&&e.length<=30||"Name must be less than 10 characters"],gameID:"",gameIDRules:[e=>!!e||"Game ID is required",e=>e&&5==e.length||"Game ID must be 5 characters"]}),created(){this.$store.dispatch("games/openDBChannel",{where:[["active","==",!0]]}).catch(console.error)},methods:{enterGameButton(){this.$refs.form.validate()&&(this.$store.dispatch("registerUser",{gameID:this.$store.getters["games/getIdForLink"](this.gameID),playerName:this.playerName})?console.log(this.$store.getters.user):console.log("Huuups, da ist was schief gelaufen"))},checkGameId(e){return 5==e.length?!!this.$store.getters["games/gameExists"](e)||"Not a valid Game ID":"Game ID must be 5 exactly characters in length"}},computed:{userGame(){return this.$store.getters.activeGame}},watch:{gameID:function(){this.gameID=this.gameID.replace(/[\W_]/g,""),this.gameID=this.gameID.toUpperCase()},userGame(e){e&&(this.$store.dispatch("games/closeDBChannel"),console.log("Let's go inside....."),this.$router.push({path:"/MyGame"}))}}},k=V,C=a("a523"),I=a("0e8f"),B=a("4bd4"),A=a("a722"),G=a("8654"),S=Object(l["a"])(k,$,D,!1,null,null,null),O=S.exports;u()(S,{VBtn:h["a"],VContainer:C["a"],VFlex:I["a"],VForm:B["a"],VLayout:A["a"],VTextField:G["a"]});var j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"mt-0":"","pt-0":""}},[a("v-layout",[a("v-flex",{attrs:{xs9:"",md9:"","mt-4":"","pr-3":""}},[a("join-bet",{ref:"joinBet"}),a("resolve-bet",{ref:"resolveBet"}),a("new-bet",{staticClass:"mb-6"}),this.requestedBets.length?a("v-subheader",[e._v("Angebotene Wetten")]):e._e(),e._l(this.requestedBets,function(t){return a("v-banner",{key:t.id,staticClass:"mb-2",attrs:{elevation:"2",icon:"mdi-alert-decagram-outline","single-line":""},scopedSlots:e._u([{key:"actions",fn:function(){return["wager"in t&&e.userID in t.wager?e._e():a("v-btn",{staticClass:"mb-1",attrs:{small:"",depressed:""},on:{click:function(a){return e.join(t.id)}}},[e._v("\n              einsteigen\n            ")])]},proxy:!0}],null,!0)},[a("v-row",[a("v-col",[e._v("\n              "+e._s(t.q))]),a("v-col",["wager"in t?a("div",e._l(t.wager,function(t,s){return a("v-tooltip",{key:s,attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[a("v-list-item-avatar",e._g({key:s,staticClass:"mt-0 mr-0 mb-0 ml-0",attrs:{color:e.$store.getters["players/list"].find(function(e){return e.id==s}).color,size:"28"}},r),[e._v("\n                      "+e._s(e.$store.getters["players/list"].find(function(e){return e.id==s}).initials)+"     \n                    ")])]}}],null,!0)},[a("span",[e._v(e._s(e.$store.getters["players/list"].find(function(e){return e.id==s}).name))])])}),1):e._e()])],1),a("v-progress-linear",{attrs:{value:t.pbWidth,color:t.color,absolute:"",bottom:""}})],1)}),a("v-subheader",[e._v("Aktive Wetten")]),e._l(this.runningBets,function(t){return a("v-banner",{key:t.id,staticClass:"mb-2",attrs:{elevation:"2","single-line":""},scopedSlots:e._u([{key:"actions",fn:function(){return[a("v-progress-circular",{attrs:{value:t.nVerdicts/Math.ceil(.51*Object.keys(t.wager).length)*100,size:"30",color:"grey"}},[e._v(e._s(Math.ceil(.51*Object.keys(t.wager).length)))]),a("v-btn",{staticClass:"mb-1",attrs:{disabled:!(e.userID in t.wager),small:"",color:"secondary"},on:{click:function(a){return e.resolve(t.id)}}},[e._v("\n              auflösen\n            ")])]},proxy:!0}],null,!0)},[a("v-row",[a("v-col",[e._v("\n              "+e._s(t.q)+"\n              "),a("ol",{staticClass:"body-2"},e._l(t.a,function(s,r){return a("li",{key:r},[e._v(e._s(s)+"\n                  "),e._l(t.selection,function(t,s){return a("span",{key:s},[t==r?a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[a("v-list-item-avatar",e._g({key:s,staticClass:"mt-0 mr-1 mb-0 ml-0 overline",attrs:{color:e.$store.getters["players/list"].find(function(e){return e.id==s}).color,size:"10"}},r))]}}],null,!0)},[a("span",[e._v(e._s(e.$store.getters["players/list"].find(function(e){return e.id==s}).initials))])]):e._e()],1)})],2)}),0)])],1),a("v-row",{staticClass:"caption mt-0 pt0"})],1)})],2),a("v-flex",{attrs:{md3:""}},[a("scoreboard")],1)],1)],1)},q=[],N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({attrs:{color:"primary",block:""}},s),[e._v("Neue Wette")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-form",{ref:"newBetForm",attrs:{"lazy-validation":""},nativeOn:{submit:function(t){return t.preventDefault(),e.submitBet(t)}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v("Neue Wette anbieten")])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{rules:e.QuestionRules,label:"Wette eingeben *",required:""},model:{value:e.q,callback:function(t){e.q=t},expression:"q"}})],1),a("v-col",{attrs:{cols:"12"}},[a("h3",[e._v("Antwortmöglichkeiten:")])]),a("v-col",{attrs:{cols:"11",offset:"1"}},[a("v-text-field",{attrs:{rules:e.AnswerRules,label:"Bitte eingeben*",required:"",hint:"Antwort 1","persistent-hint":""},model:{value:e.a[1],callback:function(t){e.$set(e.a,1,t)},expression:"a[1]"}}),a("v-text-field",{attrs:{rules:e.AnswerRules,label:"Bitte eingeben*",required:"",hint:"Antwort 2","persistent-hint":""},model:{value:e.a[2],callback:function(t){e.$set(e.a,2,t)},expression:"a[2]"}}),a("v-text-field",{attrs:{label:"Bitte eingeben",hint:"Antwort 3","persistent-hint":""},model:{value:e.a[3],callback:function(t){e.$set(e.a,3,t)},expression:"a[3]"}}),a("v-text-field",{attrs:{label:"Bitte eingeben",hint:"Antwort 4","persistent-hint":""},model:{value:e.a[4],callback:function(t){e.$set(e.a,4,t)},expression:"a[4]"}}),a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:""!=e.a[4],expression:"a[4]==''?false:true"}],attrs:{label:"Bitte eingeben",hint:"Antwort 5","persistent-hint":""},model:{value:e.a[5],callback:function(t){e.$set(e.a,5,t)},expression:"a[5]"}}),a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:""!=e.a[5],expression:"a[5]==''?false:true"}],attrs:{label:"Bitte eingeben",hint:"Antwort 6","persistent-hint":""},model:{value:e.a[6],callback:function(t){e.$set(e.a,6,t)},expression:"a[6]"}}),a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:""!=e.a[6],expression:"a[6]==''?false:true"}],attrs:{label:"Bitte eingeben",hint:"Antwort 7","persistent-hint":""},model:{value:e.a[7],callback:function(t){e.$set(e.a,7,t)},expression:"a[7]"}}),a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:""!=e.a[7],expression:"a[7]==''?false:true"}],attrs:{label:"Bitte eingeben",hint:"Antwort 8","persistent-hint":""},model:{value:e.a[8],callback:function(t){e.$set(e.a,8,t)},expression:"a[8]"}}),a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:""!=e.a[8],expression:"a[8]==''?false:true"}],attrs:{label:"Bitte eingeben",hint:"Antwort 9","persistent-hint":""},model:{value:e.a[9],callback:function(t){e.$set(e.a,9,t)},expression:"a[9]"}}),a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:""!=e.a[9],expression:"a[9]==''?false:true"}],attrs:{label:"Bitte eingeben",hint:"Antwort 10","persistent-hint":""},model:{value:e.a[10],callback:function(t){e.$set(e.a,10,t)},expression:"a[10]"}})],1)],1)],1),a("small",[e._v("*indicates required field")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Close")]),a("v-btn",{attrs:{color:"blue darken-1",text:"",type:"submit"}},[e._v("Save")])],1)],1)],1)],1)},P=[],F={data:()=>({a:[],q:"",dialog:!1,valid:!0,QuestionRules:[e=>!!e||'Bitte Wette eingeben, z.B. "Das nächste Fieldgoal erzielt..."'],AnswerRules:[e=>!!e||"Mindestens 2 Antwortmöglichkeiten sind notwendig"]}),created(){for(var e=1;e<10;e++)this.a[e]=""},methods:{submitBet(){if(this.$refs.newBetForm.validate()){var e=[];for(let a of this.a)""!=a&&void 0!=a&&null!=a&&e.push(a);const t={q:this.q,a:e,state:"requested"};console.log(t),this.$store.dispatch("bets/insert",t).catch(console.error).then(()=>{for(var e=1;e<10;e++)this.a[e]="";this.q="",this.valid=!0,this.dialog=!1,this.players=[]})}}},watch:{dialog(e){if(1==e){for(var t=1;t<10;t++)this.a[t]="";this.q="",this.valid=!0,this.players=[]}}}},L=F,R=a("b0af"),T=a("99d9"),U=a("62ad"),E=a("169a"),M=a("0fd9"),z=Object(l["a"])(L,N,P,!1,null,null,null),W=z.exports;u()(z,{VBtn:h["a"],VCard:R["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:T["c"],VCol:U["a"],VContainer:C["a"],VDialog:E["a"],VForm:B["a"],VRow:M["a"],VSpacer:b["a"],VTextField:G["a"]});var H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-form",{ref:"joinBetForm",attrs:{"lazy-validation":""},nativeOn:{submit:function(t){return t.preventDefault(),e.submitBet(t)}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.content.q))])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-subheader",[e._v("Deine Antwort:")])],1),a("v-row",[a("v-radio-group",{staticClass:"pl-2 pr-2 mt-0 pt-0 mb-0 pb-0",attrs:{rules:e.AnswerRules},model:{value:e.userAnswer,callback:function(t){e.userAnswer=t},expression:"userAnswer"}},e._l(e.content.a,function(e,t){return a("v-radio",{key:t,attrs:{label:e,value:t}})}),1)],1)],1),a("v-container",[a("v-row",[a("v-subheader",[e._v("Dein Einsatz: "),a("h3",{staticStyle:{"margin-top":"-2px","margin-left":"4px"}},[e._v(e._s(e.bet))])])],1),a("v-row",[a("v-slider",{staticClass:"pl-2 pr-2",attrs:{step:"5",min:"5",max:"25",ticks:""},model:{value:e.bet,callback:function(t){e.bet=t},expression:"bet"}})],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Close")]),a("v-btn",{attrs:{color:"blue darken-1",text:"",type:"submit"}},[e._v("Save")])],1)],1)],1)],1)},J=[],K={data:()=>({content:{q:"",a:[]},dialog:!1,valid:!0,userAnswer:null,bet:null,AnswerRules:[e=>null!=e||"Antwortmöglichkeit auswählen"]}),created(){},methods:{submitBet(){if(this.$refs.joinBetForm.validate()){var e={},t={};e[this.$store.getters.userID]=this.bet,t[this.$store.getters.userID]=this.userAnswer,this.$store.dispatch("bets/patch",{id:this.content.id,wager:e,selection:t}).catch(console.error).then(()=>{this.dialog=!1,this.$store.dispatch("players/addUserScore",{user:this.$store.getters.userID,score:-this.bet})})}}},watch:{}},Q=K,Z=a("67b6"),X=a("43a6"),Y=a("ba0d"),ee=a("e0c7"),te=Object(l["a"])(Q,H,J,!1,null,null,null),ae=te.exports;u()(te,{VBtn:h["a"],VCard:R["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:T["c"],VContainer:C["a"],VDialog:E["a"],VForm:B["a"],VRadio:Z["a"],VRadioGroup:X["a"],VRow:M["a"],VSlider:Y["a"],VSpacer:b["a"],VSubheader:ee["a"]});var se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-form",{ref:"resolveForm",attrs:{"lazy-validation":""},nativeOn:{submit:function(t){return t.preventDefault(),e.resolveBet(t)}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.content.q))])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-subheader",[e._v("Die richtige Antwort lautet:")])],1),a("v-row",[a("v-radio-group",{staticClass:"pl-2 pr-2 mt-0 pt-0 mb-0 pb-0",model:{value:e.userAnswer,callback:function(t){e.userAnswer=t},expression:"userAnswer"}},e._l(e.content.a,function(e,t){return a("v-radio",{key:t,attrs:{label:e,value:t}})}),1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Abbrechen")]),a("v-btn",{attrs:{color:"blue darken-1",text:"",type:"submit"}},[e._v("OK")])],1)],1)],1)],1)},re=[],ne={data:()=>({content:{q:"",a:[]},dialog:!1,valid:!0,userAnswer:null,bet:null}),created(){},methods:{resolveBet(){var e={};e[this.$store.getters.userID]=this.userAnswer,this.$store.dispatch("bets/patch",{id:this.content.id,verdict:e}).catch(console.error).then(()=>{this.dialog=!1,this.userAnswer=null,this.valid=!0})}},watch:{dialog(e){1==e&&(this.q="",this.valid=!0,this.userAnswer=null)}}},ie=ne,oe=Object(l["a"])(ie,se,re,!1,null,null,null),le=oe.exports;u()(oe,{VBtn:h["a"],VCard:R["a"],VCardActions:T["a"],VCardText:T["b"],VCardTitle:T["c"],VContainer:C["a"],VDialog:E["a"],VForm:B["a"],VRadio:Z["a"],VRadioGroup:X["a"],VRow:M["a"],VSpacer:b["a"],VSubheader:ee["a"]});var ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-navigation-drawer",{attrs:{permanent:"",right:""}},[a("v-list",{attrs:{disabled:""}},[a("v-subheader",[e._v("Scoreboard")]),a("v-list-item-group",{attrs:{color:"primary"}},e._l(this.$store.getters["players/listActive"],function(t){return a("v-list-item",{key:t.id,class:t.id==e.userID?"grey lighten-4":""},[a("v-list-item-avatar",{staticClass:"caption",attrs:{color:t.color,size:"24"}},[e._v("\n              "+e._s(t.initials)+"\n            ")]),a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t["name"])}})],1),a("v-list-item-content",{staticClass:"right"},[a("v-list-item-title",{staticClass:"text-right",domProps:{textContent:e._s(t["score"])}})],1)],1)}),1)],1),a("v-expansion-panels",{staticClass:"overline ml-1 mr-1 mt-10"},[a("v-expansion-panel",{key:1},[a("v-expansion-panel-header",{staticClass:"overline"},[e._v("Debug Info loaded Game")]),a("v-expansion-panel-content",[e._v("\n            "+e._s(this.$store.getters.loadedGame)+"\n          ")])],1),a("v-expansion-panel",{key:2},[a("v-expansion-panel-header",{staticClass:"overline"},[e._v("Debug Info players")]),a("v-expansion-panel-content",[e._v("\n            "+e._s(this.$store.getters["players/list"])+"\n          ")])],1),a("v-expansion-panel",{key:3},[a("v-expansion-panel-header",{staticClass:"overline"},[e._v("Debug Info bets")]),a("v-expansion-panel-content",[e._v("\n            "+e._s(this.$store.getters["bets/list"])+"\n          ")])],1),a("v-expansion-panel",{key:4},[a("v-expansion-panel-header",{staticClass:"overline"},[e._v("Debug Info current user")]),a("v-expansion-panel-content",[e._v("\n            "+e._s(this.$store.getters.user)+"\n          ")])],1)],1)],1)},ue=[],de={data:()=>({}),created(){},computed:{userGame(){return this.$store.getters.activeGame},userID(){return this.$store.getters.userID}},methods:{}},ve=de,he=a("cd55"),pe=a("49e2"),me=a("c865"),ge=a("0393"),fe=a("8860"),be=a("da13"),ye=a("8270"),we=a("5d23"),xe=a("1baa"),_e=a("f774"),$e=Object(l["a"])(ve,ce,ue,!1,null,null,null),De=$e.exports;u()($e,{VExpansionPanel:he["a"],VExpansionPanelContent:pe["a"],VExpansionPanelHeader:me["a"],VExpansionPanels:ge["a"],VList:fe["a"],VListItem:be["a"],VListItemAvatar:ye["a"],VListItemContent:we["a"],VListItemGroup:xe["a"],VListItemTitle:we["b"],VNavigationDrawer:_e["a"],VSubheader:ee["a"]});var Ve={props:["id"],data:()=>({now:Date.now(),requestedBets:[],runningBets:[],watchdogInterval:null}),components:{"new-bet":W,"join-bet":ae,"resolve-bet":le,scoreboard:De},created(){this.$store.getters.activeGame?(console.log("Active Game detected -> let's start up the database connections"),this.$store.dispatch("bets/openDBChannel",{gameID:this.$store.getters.activeGame}),this.$store.dispatch("players/openDBChannel",{gameID:this.$store.getters.activeGame}),console.log("check if user is already part of the game..."),this.$store.getters.userID in this.$store.getters["players/userExists"]||this.$store.dispatch("players/insert",Object.assign(this.$store.getters.user,{score:10,last_online:Date.now()})),this.watchdog(),this.watchdogInterval=setInterval(()=>{this.watchdog()},1e4)):(console.log("No active Game. Redirect to home"),this.$router.push({path:"/"}))},beforeDestroy(){clearInterval(this.watchdogInterval)},methods:{join(e){this.$refs.joinBet.content=this.$store.getters["bets/listActiveState"].find(t=>t.id==e),this.$refs.joinBet.dialog=1,console.log(this.$refs.joinBet.content)},resolve(e){this.$refs.resolveBet.content=this.$store.getters["bets/listActiveState"].find(t=>t.id==e),this.$refs.resolveBet.dialog=1,console.log(this.$refs.resolveBet.content)},watchdog(){this.$store.getters["players/userExists"](this.$store.getters.userID)||this.$store.dispatch("players/insert",Object.assign(this.$store.getters.user,{score:10,last_online:Date.now()})),(Date.now()-this.$store.getters["players/getUserLastOn"](this.$store.getters.userID))/1e3>30&&(console.log("Alive! "+Date.now()),this.$store.dispatch("players/patch",{id:this.$store.getters.userID,last_online:Date.now()}).catch(console.error).then(()=>{})),this.requestedBets=[],this.runningBets=[];const e=60;var t=null,a=null;for(var s of this.$store.getters["bets/listActiveState"])a="seconds"in s.created_at&&(null!=s.created_at.seconds||void 0!=s.created_at.seconds)?s.created_at.seconds:Date.parse(s.created_at)/1e3,t=Math.round(Date.now()/1e3)-a,"requested"==s.state&&t>e&&("wager"in s?(console.log("Bieter: '"+s.q+"': "+Object.keys(s.wager).length),Object.keys(s.wager).length<2?this.$store.dispatch("bets/patch",{id:s.id,state:"declined"}):this.$store.dispatch("bets/patch",{id:s.id,state:"running"})):(console.log("Keiner hat geboten auf '"+s.q+"'"),this.$store.dispatch("bets/patch",{id:s.id,state:"declined"})));for(s of this.$store.getters["bets/listActiveState"])if(a="seconds"in s.created_at&&(null!=s.created_at.seconds||void 0!=s.created_at.seconds)?s.created_at.seconds:Date.parse(s.created_at)/1e3,t=Math.round(Date.now()/1e3)-a,"requested"==s.state){var r=Math.max(e-t,0)/e*100,n="#29B6F6";r<17?n="#FF3D00":r<33&&(n="#FFCA28"),this.requestedBets.push(Object.assign(s,{age:t,color:n,pbWidth:r}))}else"running"==s.state?this.runningBets.push(Object.assign(s,{age:Math.round(Date.now()/1e3)-s.created_at.seconds,nVerdicts:"verdict"in s?Object.keys(s.verdict).length:null})):console.log("That shouldn't happen: "+s)},playSound(e){if(e){var t=new Audio(e);t.play()}}},computed:{userGame(){return this.$store.getters.activeGame},userID(){return this.$store.getters.userID},activeStateBetsGetter(){return this.$store.getters["bets/listActiveState"]},verdicts(){var e=[];for(var t of this.$store.getters["bets/listActiveState"])"running"==t.state&&(e[t.id]="verdict"in t?Object.keys(t.verdict).length:0);return e}},watch:{userGame(e){e||(this.$store.dispatch("players/closeDBChannel",{clearModule:!0}),this.$store.dispatch("bets/closeDBChannel",{clearModule:!0}),console.log("Let's switch to home....."),this.$router.push({path:"/"}))},activeStateBetsGetter(){this.playSound(a("73c1")),this.watchdog()},verdictList:{handler:function(e,t){console.log(e),console.log(t)},deep:!0}}},ke=Ve,Ce=a("e4e5"),Ie=a("8e36"),Be=a("3a2f"),Ae=Object(l["a"])(ke,j,q,!1,null,null,null),Ge=Ae.exports;u()(Ae,{VBanner:Ce["a"],VBtn:h["a"],VCol:U["a"],VContainer:C["a"],VFlex:I["a"],VLayout:A["a"],VListItemAvatar:ye["a"],VProgressCircular:f["a"],VProgressLinear:Ie["a"],VRow:M["a"],VSubheader:ee["a"],VTooltip:Be["a"]}),s["a"].use(_["a"]);var Se=new _["a"]({mode:"history",base:"/betsy/",routes:[{path:"/",name:"Home",component:O},{path:"/MyGame",name:"MyGame",component:Ge}]}),Oe=a("2f62"),je=a("34ed"),qe=a("8aa5");a("e71f");function Ne(){return qe["initializeApp"]({apiKey:"AIzaSyCFg-7IkXZmakFDniHFwgpZEwxn0t5Uz2Q",authDomain:"betsy-14cf1.firebaseapp.com",databaseURL:"https://betsy-14cf1.firebaseio.com",projectId:"betsy-14cf1",appId:"1:53420329992:web:86b65cbedb538492"}),new Promise((e,t)=>{qe["firestore"]().enablePersistence().then(e).catch(e=>{"failed-precondition"===e.code?t(e):"unimplemented"===e.code&&t(e)})})}const Pe={firestorePath:"games",firestoreRefType:"collection",moduleName:"games",statePropName:"synced",namespaced:!0,state:{},getters:{listGames(e){const t=[];for(var a in e.synced)t.push(e.synced[a]);return t},gameExists:e=>t=>{for(var a in e.synced)if(e.synced[a].link==t)return!0;return!1},getIdForLink:e=>t=>{for(var a in e.synced)if(e.synced[a].link==t)return a;return!1}},mutations:{},actions:{}};var Fe=Pe;const Le={firestorePath:"games/{gameID}/bets",firestoreRefType:"collection",moduleName:"bets",statePropName:"synced",namespaced:!0,state:{},getters:{list(e){return null!=e.synced&&void 0!=e.synced?Object.values(e.synced).sort((e,t)=>{return t["createdAt"]-e["createdAt"]}):null},listActiveState(e){return null!=e.synced&&void 0!=e.synced?Object.values(e.synced).filter(e=>"requested"==e.state||"running"==e.state).sort((e,t)=>{return e["createdAt"]-t["createdAt"]}):null}},mutations:{},actions:{}};var Re=Le;const Te={firestorePath:"games/{gameID}/players",firestoreRefType:"collection",moduleName:"players",statePropName:"synced",namespaced:!0,state:{},getters:{list(e){return null!=e.synced&&void 0!=e.synced?Object.values(e.synced).sort((e,t)=>{return t["score"]-e["score"]}):null},listActive(e){return null!=e.synced&&void 0!=e.synced?Object.values(e.synced).filter(e=>e.last_online+12e4>Date.now()&&null!=e.activeGame).sort((e,t)=>{return t["score"]-e["score"]}):null},getUserLastOn:e=>t=>{return null!=e.synced&&void 0!=e.synced&&t in e.synced?e.synced[t].last_online:null},userExists:e=>t=>{return null!=e.synced&&void 0!=e.synced&&t in e.synced}},mutations:{reset(e){e.synced=null},addUserScore(e,t){e.synced[t.user].score+=t.score}},actions:{reset({commit:e}){e("reset")},addUserScore({commit:e},t){e("addUserScore",t)}}};var Ue=Te;s["a"].use(Oe["a"]);const Ee=Object(je["a"])([Fe,Ue,Re],{logging:!0,FirebaseDependency:qe}),Me={plugins:[Ee],state:{user:null,loader:!1},mutations:{setUser(e,t){e.user=t},setLoader(e,t){e.loader=t}},computed:{},actions:{enterGame({state:e,dispatch:t}){return new Promise((a,s)=>{""!=e.user.activeGame&&null!=e.user.activeGame&&void 0!=e.user.activeGame?(t("games/closeDBChannel").catch(e=>{s("close GameDB ging nicht: "+e)}),t("players/openDBChannel",{gameID:e.user.activeGame}).catch(e=>{s("open Player DB ging nicht: "+e)}).then(()=>{t("players/insert",Object.assign(e.user,{score:10,last_online:Date.now()})).catch(e=>{s("insert user in players ging nicht: "+e)}).then(()=>{t("bets/openDBChannel",{gameID:e.user.activeGame}).catch(e=>{s("open Bets DB ging nicht: "+e)}).then(()=>{console.log("Signed In"),a("läuft!")})})})):s("hat garnicht geklappt")})},leaveGame({state:e,dispatch:t}){t("players/patch",{id:e.user.id,activeGame:null}).catch(console.error).then(()=>{qe.database().ref("/users/"+e.user.id).remove().then(()=>{qe.auth().signOut().then(function(){console.log("Signed Out")},function(e){console.error("Sign Out Error",e)})})})},registerUser({commit:e},t){qe.auth().signInAnonymously().then(s=>{var r=t.playerName.substr(0,1).toUpperCase()+t.playerName.substr(-1).toUpperCase(),n=a("fd9b"),i=n({luminosity:"light"});const o={id:s.user.uid,name:t.playerName,activeGame:t.gameID,initials:r,color:i};console.log(s.user.uid),qe.database().ref("/users/"+o.id).set(o),e("setUser",o)}).catch(e=>{console.log(e)})},setUser(e,t){e.commit("setUser",t)},loaderOn({commit:e}){e("setLoader",!0)},loaderOff({commit:e}){e("setLoader",!1)}},getters:{activeGame(e){return null!=e.user&&""!=e.user.activeGame&&null!=e.user.activeGame&&void 0!=e.user.activeGame?e.user.activeGame:null},user(e){return e.user},userID(e){return null!=e.user&&void 0!=e.user?e.user.id:null},loader(e){return e.loader}}},ze=new Oe["a"].Store(Me);Ne().catch(e=>{console.log(e)}),qe.auth().onAuthStateChanged(e=>{e?(console.log("auth()-State: UID="+e.uid),qe.database().ref("/users/"+e.uid).on("value",function(e){ze.dispatch("setUser",e.val())})):(console.log("auth()-State: no User"),ze.dispatch("setUser",null))});var We=ze,He=a("f309");s["a"].use(He["a"]);var Je=new He["a"]({icons:{iconfont:"mdi"}});s["a"].config.productionTip=!1,new s["a"]({router:Se,store:We,vuetify:Je,render:e=>e(x),created(){}}).$mount("#app")},"73c1":function(e,t,a){e.exports=a.p+"media/sound5.4701dd13.mp3"}});
//# sourceMappingURL=app.888758ad.js.map